<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/chart-elements/chart-elements.html">
<link rel="import" href="../bower_components/paper-input-autocomplete-chips/paper-input-autocomplete-chips.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/paper-input-autocomplete/paper-input-autocomplete.html">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<dom-module id="my-view1">
  <template>
    <chart-pie id="chart" class="square-chart" data="[[data]]"></chart-pie>

    <div class="controls">
      <div class="control-group">
        <label>
            Value
            <input id="newValue" type="text" value="200">
          </label>
        <label>
            Color
            <input id="newColor" type="text" value="#949FB1">
          </label>
        <label>
            Highlight
            <input id="newHighlight" type="text" value="#A8B3C5">
          </label>
        <label>
            Label
            <input id="newLabel" type="text" value="Grey">
          </label>
        <button type="button" name="button" on-tap="addData">Add data</button>
        <paper-button raised>raised</paper-button>
      </div>
      <div class="control-group">
        <label>
            Width
            <input id="newWidth" type="text" value="150px">
          </label>
        <label>
            Height
            <input id="newHeight" type="text" value="150px">
          </label>
        <button type="button" name="button" on-tap="resize">Resize</button>
      </div>
    </div>
    <!--<iron-ajax id="requestRepos" method="GET" handle-as="json" Â url="http://localhost:55911/api/values" on-response="handleResponse">-->
    <div>
      <!--<paper-material class="demo-paper" style="height: 300px; overflow: auto;">-->
        <p>An example of <code>&lt;paper-input-autocomplete-chips&gt;</code>:</p>
        <paper-input-autocomplete-chips  label="Chips">
          <!--<iron-icon icon="visibility" prefix></iron-icon>
          <iron-icon icon="visibility" suffix></iron-icon>-->
        </paper-input-autocomplete-chips>
      <!--</paper-material>-->
    </div>
    </iron-ajax>
  </template>

  <script>
    function initializechart() {
      var scope = document.querySelector('#chart');
      //  console.log("Message here")
      //  console.log(scope)
      scope.data = {
        labels: [
          "Red",
          "Green",
          "Yellow"
        ],
        datasets: [
          {
            data: [300, 50, 100],
            backgroundColor: [
              "#FF6384",
              "#36A2EB",
              "#FFCE56"
            ],
            hoverBackgroundColor: [
              "#FF6384",
              "#36A2EB",
              "#FFCE56"
            ]
          }]
      };

      scope.resize = function () {
        this.$.chart.style.width = this.$.newWidth.value;
        this.$.chart.style.height = this.$.newHeight.value;
        this.$.chart.resize();
      };
    }


    function showResult(json) {
      alert(json);
    }
    Polymer({
      is: 'my-view1',
      ready: function () {
        console.log("Called")
        // document.querySelector("#requestRepos").generateRequest();
        initializechart();

        $.ajax({
          type: 'GET',
          dataType: 'jsonp',
          url: 'http://localhost:53145/api/nuxeoconnect',
          jsonpCallback: 'showResult',
          error: function (data, msg) {
            alert("Error");
            alert(msg);
          },
          success: function (data) {
            alert('success')
            console.log(data)
          }
        });
        //return false;
      }
    });
  </script>
</dom-module>